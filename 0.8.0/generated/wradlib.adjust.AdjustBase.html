

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>wradlib.adjust.AdjustBase &mdash; wradlib</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/wradlib.css" type="text/css" />
  

  

  
    <link rel="top" title="wradlib" href="../index.html"/>
        <link rel="up" title="Gage adjustment" href="../adjust.html"/>
        <link rel="next" title="wradlib.adjust.AdjustBase.__call__" href="wradlib.adjust.AdjustBase.__call__.html"/>
        <link rel="prev" title="Gage adjustment" href="../adjust.html"/>
    
    <link href="../_static/wradlib.css" rel="stylesheet" type="text/css">


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

  <a href="../index.html" class="icon icon-home"> wradlib



</a>



  <div class="version">
    
    <button class="verbtn">0.8.0</button>
    <div class="version-content">
      
        <a href="../latest/">latest</a>
        <a href="../0.8.0/">0.8.0</a>
        <a href="../0.7.6/">0.7.6</a>
        <a href="../0.7.0/">0.7.0</a>
        <a href="../0.6.0/">0.6.0</a>
    </div>
  </div>



<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">Recipes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">Library Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../io.html">Raw Data I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trafo.html">Data Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zr.html">Z-R Conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../georef.html">Georeferencing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipol.html">Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qual.html">Data Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../comp.html">Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clutter.html">Clutter Identification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dp.html">Dual-Pol and Differential Phase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fill.html">Filling Missing Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vpr.html">Vertical Profile of Reflectivity (VPR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../atten.html">Attenuation Correction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../adjust.html">Gage adjustment</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../adjust.html#concept">Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="../adjust.html#quick-start">Quick start</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../adjust.html#cross-validation">Cross validation</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="">wradlib.adjust.AdjustBase</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.AdjustMFB.html">wradlib.adjust.AdjustMFB</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.AdjustMultiply.html">wradlib.adjust.AdjustMultiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.AdjustAdd.html">wradlib.adjust.AdjustAdd</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.AdjustMixed.html">wradlib.adjust.AdjustMixed</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.Raw_at_obs.html">wradlib.adjust.Raw_at_obs</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.GageOnly.html">wradlib.adjust.GageOnly</a></li>
<li class="toctree-l4"><a class="reference internal" href="wradlib.adjust.AdjustNone.html">wradlib.adjust.AdjustNone</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../verify.html">Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vis.html">Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zonalstats.html">Zonal Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../util.html">Utility functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../community.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_setup.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">wradlib</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../reference.html">Library Reference</a> &raquo;</li>
      
          <li><a href="../adjust.html">Gage adjustment</a> &raquo;</li>
      
    <li>wradlib.adjust.AdjustBase</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/generated/wradlib.adjust.AdjustBase.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="wradlib-adjust-adjustbase">
<h1>wradlib.adjust.AdjustBase<a class="headerlink" href="#wradlib-adjust-adjustbase" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="wradlib.adjust.AdjustBase">
<em class="property">class </em><code class="descclassname">wradlib.adjust.</code><code class="descname">AdjustBase</code><span class="sig-paren">(</span><em>obs_coords</em>, <em>raw_coords</em>, <em>nnear_raws=9</em>, <em>stat='median'</em>, <em>mingages=5</em>, <em>minval=0.0</em>, <em>mfb_args=None</em>, <em>Ipclass=&lt;class wradlib.ipol.Idw&gt;</em>, <em>**ipargs</em><span class="sig-paren">)</span><a class="headerlink" href="#wradlib.adjust.AdjustBase" title="Permalink to this definition">¶</a></dt>
<dd><p>The basic adjustment class that inherits to all other classes.</p>
<p>All methods except the <code class="docutils literal"><span class="pre">__call__</span></code> method are inherited to the following adjustment classes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>obs_coords</strong> (<em>array of floats of shape (number of points, 2)</em>) &#8211; x and y coordinate pairs of observation locations (e.g. rain gauges).</li>
<li><strong>raw_coords</strong> (<em>array of floats of shape (number of points, 2)</em>) &#8211; x and y coordinate pairs of raw (unadjusted) radar field</li>
<li><strong>nnear_raws</strong> (<em>integer</em>) &#8211; Defaults to 9. This parameter controls the number of radar bins or
grid cells (in the neighbourhood of a rain gauge) which is used to
compute the value of the radar observation AT a rain gauge.</li>
<li><strong>stat</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Defaults to &#8216;median&#8217;. Must be either &#8216;mean&#8217;, &#8216;median&#8217;, or &#8216;best&#8217;.
This parameter controls the statistic that is used to compute the value
of the radar observation AT a rain gauge based on the neighbourhood
specified by parameter nnear_raws.</li>
<li><strong>mingages</strong> (<em>integer</em>) &#8211; Defaults to 5. Minimum number of valid gages required for an adjustment. If less valid
gauges are available, the adjustment procedure will return unadjusted raw
values. If you do not want to use this feature, you need to set mingages=0.</li>
<li><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; If the gage or radar observation is below this threshold, the location
will not be used for adjustment. For additive adjustment, this value
should be set to zero (default value). For multiplicative adjustment,
values larger than zeros might be chosen in order to minimize artifacts.</li>
<li><strong>mfb_args</strong> (<em>dictionary</em>) &#8211; <p><strong>Only used for AdjustMFB</strong> - This set of parameters controls how the mean
field bias is computed. Items of the dictionary are:</p>
<ul>
<li><em>method</em>: string
defaults to &#8220;linregr&#8221; which fits a regression line through observed and
estimated values and than gets the bias from the inverse of the slope.
Other values: &#8220;mean&#8221; or &#8220;median&#8221; compute the mean or the median of the ratios between
gauge and radar observations.</li>
<li><em>minslope</em>, <em>minr</em>, <em>maxp</em>:
When using method=&#8221;linregr&#8221;, these parameters control whether a linear regression
turned out to be robust (minimum allowable slope, minimum allowable correlation,
maximim allowable p-value). If the regression result is not considered robust,
no adjustment will take place.</li>
</ul>
</li>
<li><strong>Ipclass</strong> (<em>an interpolation class from wradib.ipol</em>) &#8211; <strong>Not used for AdjustMFB</strong> - default value is wradlib.ipol.Idw
(Inverse Distance Weighting).</li>
<li><strong>ipargs</strong> (<em>keyword arguments to create an instance of Ipclass</em>) &#8211; <strong>Not used for AdjustMFB</strong> - for wradlib.ipol.Idw, these keyword
arguments would e.g. be nnear or p.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>See <a class="reference download internal" href="../_downloads/adjust_example.py"><code class="xref download docutils literal"><span class="pre">adjust_example.py</span> <span class="pre">script</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># -------------------------------------------------------------------------------</span>
<span class="c1"># Name:        adjust_example.py</span>
<span class="c1"># Purpose:</span>
<span class="c1">#</span>
<span class="c1"># Author:      heistermann</span>
<span class="c1">#</span>
<span class="c1"># Created:     28.10.2011</span>
<span class="c1"># Copyright:   (c) heistermann 2011</span>
<span class="c1"># Licence:     The MIT License</span>
<span class="c1"># -------------------------------------------------------------------------------</span>
<span class="c1">#!/usr/bin/env python</span>

<span class="kn">import</span> <span class="nn">wradlib.adjust</span> <span class="kn">as</span> <span class="nn">adjust</span>
<span class="kn">import</span> <span class="nn">wradlib.verify</span> <span class="kn">as</span> <span class="nn">verify</span>
<span class="kn">import</span> <span class="nn">wradlib.util</span> <span class="kn">as</span> <span class="nn">util</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">pl</span>
<span class="c1">#pl.interactive(True)</span>

<span class="k">def</span> <span class="nf">ex_adjust</span><span class="p">():</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># 1d Example ##############################################################</span>
    <span class="c1">###########################################################################</span>

    <span class="c1"># gage and radar coordinates</span>
    <span class="n">obs_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
    <span class="n">radar_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>

    <span class="c1"># true rainfall</span>
    <span class="n">truth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.075</span> <span class="o">*</span> <span class="n">radar_coords</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">))</span>

    <span class="c1"># radar error</span>
    <span class="n">erroradd</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">radar_coords</span> <span class="o">+</span> <span class="mf">10.</span><span class="p">)</span>
    <span class="n">errormult</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.015</span> <span class="o">*</span> <span class="n">radar_coords</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">))</span>

    <span class="c1"># radar observation</span>
    <span class="n">radar</span> <span class="o">=</span> <span class="n">errormult</span> <span class="o">*</span> <span class="n">truth</span> <span class="o">+</span> <span class="n">erroradd</span> <span class="o">+</span> <span class="n">noise</span>

    <span class="c1"># gage observations are assumed to be perfect</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">truth</span><span class="p">[</span><span class="n">obs_coords</span><span class="p">]</span>

    <span class="c1"># add a missing value to observations (just for testing)</span>
    <span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># number of neighbours to be used</span>
    <span class="n">nnear_raws</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="c1"># adjust the radar observation by additive model</span>
    <span class="n">add_adjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustAdd</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">radar_coords</span><span class="p">,</span> <span class="n">nnear_raws</span><span class="o">=</span><span class="n">nnear_raws</span><span class="p">)</span>
    <span class="n">add_adjusted</span> <span class="o">=</span> <span class="n">add_adjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># adjust the radar observation by multiplicative model</span>
    <span class="n">mult_adjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustMultiply</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">radar_coords</span><span class="p">,</span> <span class="n">nnear_raws</span><span class="o">=</span><span class="n">nnear_raws</span><span class="p">)</span>
    <span class="n">mult_adjusted</span> <span class="o">=</span> <span class="n">mult_adjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># adjust the radar observation by MFB</span>
    <span class="n">mfb_adjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustMFB</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">radar_coords</span><span class="p">,</span> <span class="n">nnear_raws</span><span class="o">=</span><span class="n">nnear_raws</span><span class="p">)</span>
    <span class="n">mfb_adjusted</span> <span class="o">=</span> <span class="n">mfb_adjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># adjust the radar observation by AdjustMixed</span>
    <span class="n">mixed_adjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustMixed</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">radar_coords</span><span class="p">,</span> <span class="n">nnear_raws</span><span class="o">=</span><span class="n">nnear_raws</span><span class="p">)</span>
    <span class="n">mixed_adjusted</span> <span class="o">=</span> <span class="n">mixed_adjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># plotting</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">,</span> <span class="n">radar</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Unadjusted radar&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance (km)&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Rainfall intensity (mm/h)&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">,</span> <span class="n">truth</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True rainfall&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Gage observation&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">,</span> <span class="n">add_adjusted</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Additive adjustment&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">,</span> <span class="n">mult_adjusted</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multiplicative adjustment&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">,</span> <span class="n">mfb_adjusted</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mean Field Bias adjustment&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radar_coords</span><span class="p">,</span> <span class="n">mixed_adjusted</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mixed (mult./add.) adjustment&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Verification for this example</span>
    <span class="n">rawerror</span> <span class="o">=</span> <span class="n">verify</span><span class="o">.</span><span class="n">ErrorMetrics</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>
    <span class="n">mfberror</span> <span class="o">=</span> <span class="n">verify</span><span class="o">.</span><span class="n">ErrorMetrics</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">mfb_adjusted</span><span class="p">)</span>
    <span class="n">adderror</span> <span class="o">=</span> <span class="n">verify</span><span class="o">.</span><span class="n">ErrorMetrics</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">add_adjusted</span><span class="p">)</span>
    <span class="n">multerror</span> <span class="o">=</span> <span class="n">verify</span><span class="o">.</span><span class="n">ErrorMetrics</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">mult_adjusted</span><span class="p">)</span>
    <span class="n">mixerror</span> <span class="o">=</span> <span class="n">verify</span><span class="o">.</span><span class="n">ErrorMetrics</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">mixed_adjusted</span><span class="p">)</span>

    <span class="c1"># Verification reports</span>
    <span class="n">maxval</span> <span class="o">=</span> <span class="mf">4.</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">231</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">rawerror</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">,</span> <span class="s2">&quot;Unadjusted radar&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">232</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">adderror</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">,</span> <span class="s2">&quot;Additive adjustment&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">233</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">multerror</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">,</span> <span class="s2">&quot;Multiplicative adjustment&quot;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">234</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">mixerror</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">,</span> <span class="s2">&quot;Mixed (mult./add.) adjustment&quot;</span><span class="p">)</span>
    <span class="n">mixerror</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">mfberror</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;mm&quot;</span><span class="p">,</span> <span class="n">maxval</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">,</span> <span class="s2">&quot;Mean Field Bias adjustment&quot;</span><span class="p">)</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1">###########################################################################</span>
    <span class="c1"># 2d Example ##############################################################</span>
    <span class="c1">###########################################################################</span>

    <span class="c1"># a) CREATE SYNTHETIC DATA ------------------------------------------------</span>

    <span class="c1"># grid axes</span>
    <span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

    <span class="c1"># number of observations</span>
    <span class="n">num_obs</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># create grid</span>
    <span class="n">gridshape</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xgrid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">ygrid</span><span class="p">)</span>
    <span class="n">grid_coords</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">gridaspoints</span><span class="p">(</span><span class="n">ygrid</span><span class="p">,</span> <span class="n">xgrid</span><span class="p">)</span>

    <span class="c1"># Synthetic true rainfall</span>
    <span class="n">truth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">10.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">grid_coords</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Creating radar data by perturbing truth with multiplicative and additive error</span>
    <span class="c1"># YOU CAN EXPERIMENT WITH THE ERROR STRUCTURE</span>
    <span class="n">radar</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">truth</span> <span class="o">+</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">truth</span><span class="p">))</span>
    <span class="n">radar</span><span class="p">[</span><span class="n">radar</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="c1"># indices for creating obs from raw (random placement of gauges)</span>
    <span class="n">obs_ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">grid_coords</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">num_obs</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i4&#39;</span><span class="p">)</span>

    <span class="c1"># creating obs_coordinates</span>
    <span class="n">obs_coords</span> <span class="o">=</span> <span class="n">grid_coords</span><span class="p">[</span><span class="n">obs_ix</span><span class="p">]</span>

    <span class="c1"># creating gauge observations from truth</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">truth</span><span class="p">[</span><span class="n">obs_ix</span><span class="p">]</span>

    <span class="c1"># b) GAUGE ADJUSTMENT -----------------------------------------------------</span>

    <span class="c1"># Mean Field Bias Adjustment</span>
    <span class="n">mfbadjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustMFB</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">grid_coords</span><span class="p">)</span>
    <span class="n">mfbadjusted</span> <span class="o">=</span> <span class="n">mfbadjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># Additive Error Model</span>
    <span class="n">addadjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustAdd</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">grid_coords</span><span class="p">)</span>
    <span class="n">addadjusted</span> <span class="o">=</span> <span class="n">addadjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># Multiplicative Error Model</span>
    <span class="n">multadjuster</span> <span class="o">=</span> <span class="n">adjust</span><span class="o">.</span><span class="n">AdjustMultiply</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">,</span> <span class="n">grid_coords</span><span class="p">)</span>
    <span class="n">multadjusted</span> <span class="o">=</span> <span class="n">multadjuster</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">)</span>

    <span class="c1"># c) PLOTTING</span>

    <span class="c1"># Maximum value (used for normalisation of colorscales)    </span>
    <span class="n">maxval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">truth</span><span class="p">,</span> <span class="n">radar</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">addadjusted</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

    <span class="c1"># Helper functions for repeated plotting tasks</span>
    <span class="k">def</span> <span class="nf">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quick and dirty helper function to produce scatter plots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;True rainfall (mm)&quot;</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Estimated rainfall (mm)&quot;</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxval</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">maxval</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">gridplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Quick and dirty helper function to produce a grid plot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">xgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">yplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ygrid</span><span class="p">,</span> <span class="n">ygrid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">grd</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">yplot</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">gridshape</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">obs_coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">obs_coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">obs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">maxval</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">grd</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># open figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># True rainfall</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">331</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">gridplot</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="s1">&#39;True rainfall&#39;</span><span class="p">)</span>

    <span class="c1"># Unadjusted radar rainfall</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">332</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">gridplot</span><span class="p">(</span><span class="n">radar</span><span class="p">,</span> <span class="s1">&#39;Radar rainfall&#39;</span><span class="p">)</span>

    <span class="c1"># Scatter plot radar vs. observations</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">333</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">scatterplot</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">radar</span><span class="p">,</span> <span class="s1">&#39;Radar vs. Truth (red: Gauges)&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">radar</span><span class="p">[</span><span class="n">obs_ix</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

    <span class="c1"># Adjusted radar rainfall (MFB)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">334</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">gridplot</span><span class="p">(</span><span class="n">mfbadjusted</span><span class="p">,</span> <span class="s1">&#39;Adjusted (MFB)&#39;</span><span class="p">)</span>

    <span class="c1"># Adjusted radar rainfall (additive)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">335</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">gridplot</span><span class="p">(</span><span class="n">addadjusted</span><span class="p">,</span> <span class="s1">&#39;Adjusted (Add.)&#39;</span><span class="p">)</span>

    <span class="c1"># Adjusted radar rainfall (multiplicative)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">336</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">gridplot</span><span class="p">(</span><span class="n">multadjusted</span><span class="p">,</span> <span class="s1">&#39;Adjusted (Mult.)&#39;</span><span class="p">)</span>

    <span class="c1"># Adjusted (MFB) vs. radar (for control purposes)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">337</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="c1"># scatterplot(obs, mfbadjusted[obs_ix], &#39;Adjusted (MFB) vs. Gauges\n(no x-validation!)&#39;)</span>
    <span class="n">scatterplot</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">mfbadjusted</span><span class="p">,</span> <span class="s1">&#39;Adjusted (MFB) vs. Truth&#39;</span><span class="p">)</span>

    <span class="c1"># Adjusted (Add) vs. radar (for control purposes)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">338</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="c1"># scatterplot(obs, addadjusted[obs_ix], &#39;Adjusted (Add.) vs. Gauges\n(no x-validation!)&#39;)</span>
    <span class="n">scatterplot</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">addadjusted</span><span class="p">,</span> <span class="s1">&#39;Adjusted (Add.) vs. Truth&#39;</span><span class="p">)</span>

    <span class="c1"># Adjusted (Mult.) vs. radar (for control purposes)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">339</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="c1"># scatterplot(obs, multadjusted[obs_ix], &#39;Adjusted (Mult.) vs. Gauges\n(no x-validation!)&#39;)</span>
    <span class="n">scatterplot</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span> <span class="n">multadjusted</span><span class="p">,</span> <span class="s1">&#39;Adjusted (Mult.) vs. Truth&#39;</span><span class="p">)</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">ex_adjust</span><span class="p">()</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="wradlib.adjust.AdjustBase.__call__.html#wradlib.adjust.AdjustBase.__call__" title="wradlib.adjust.AdjustBase.__call__"><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code></a>(obs,&nbsp;raw[,&nbsp;targets,&nbsp;rawatobs,&nbsp;ix])</td>
<td>Returns an array of <em>raw</em> values that are adjusted by <em>obs</em>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="wradlib.adjust.AdjustBase.xvalidate.html#wradlib.adjust.AdjustBase.xvalidate" title="wradlib.adjust.AdjustBase.xvalidate"><code class="xref py py-obj docutils literal"><span class="pre">xvalidate</span></code></a>(obs,&nbsp;raw)</td>
<td>Leave-One-Out Cross Validation, applicable to all gage adjustment classes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="wradlib.adjust.AdjustBase.__call__.html#wradlib.adjust.AdjustBase.__call__" title="wradlib.adjust.AdjustBase.__call__"><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code></a>(obs,&nbsp;raw[,&nbsp;targets,&nbsp;rawatobs,&nbsp;ix])</td>
<td>Returns an array of <em>raw</em> values that are adjusted by <em>obs</em>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="wradlib.adjust.AdjustBase.xvalidate.html#wradlib.adjust.AdjustBase.xvalidate" title="wradlib.adjust.AdjustBase.xvalidate"><code class="xref py py-obj docutils literal"><span class="pre">xvalidate</span></code></a>(obs,&nbsp;raw)</td>
<td>Leave-One-Out Cross Validation, applicable to all gage adjustment classes.</td>
</tr>
</tbody>
</table>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="wradlib.adjust.AdjustBase.__call__.html" class="btn btn-neutral float-right" title="wradlib.adjust.AdjustBase.__call__" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../adjust.html" class="btn btn-neutral" title="Gage adjustment" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2011-2016, wradlib developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>